<!DOCTYPE html>
<html lang="ka">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AIWtaxi – მძღოლის კაბინეტი</title>

<style>
    body {
        background:black;
        color:white;
        font-family:Arial, sans-serif;
        text-align:center;
        padding-top:40px;
    }

    .balance {
        font-size:40px;
        color:gold;
        margin-top:10px;
    }

    .pay-btn {
        margin-top:40px;
        background:#55a8ff;
        width:220px;
        height:220px;
        border-radius:50%;
        display:flex;
        justify-content:center;
        align-items:center;
        font-size:26px;
        border:none;
        cursor:pointer;
    }

    /* Popup */
    #popup {
        display:none;
        position:fixed;
        top:0; left:0;
        width:100%; height:100%;
        background:rgba(0,0,0,0.7);
        padding-top:120px;
    }

    #popupBox {
        background:white;
        width:85%;
        margin:auto;
        padding:25px;
        border-radius:15px;
        color:black;
        text-align:center;
    }

    input {
        width:85%;
        padding:12px;
        margin:8px 0;
        border-radius:8px;
        border:1px solid gray;
        font-size:18px;
    }

    .close {
        margin-top:20px;
        padding:12px;
        width:85%;
        background:red;
        border:none;
        color:white;
        border-radius:8px;
        font-size:18px;
        cursor:pointer;
    }

    .confirm {
        background:#55a8ff;
        color:white;
        border:none;
        padding:12px;
        width:85%;
        border-radius:8px;
        font-size:20px;
        font-weight:bold;
        cursor:pointer;
    }

</style>

</head>

<body>

<h2 style="color:gold;">AIWtaxi – მძღოლის კაბინეტი</h2>

<h3>ტელეფონი:</h3>
<p id="driverPhone" style="font-size:22px;"></p>

<h3>ბალანსი:</h3>
<div class="balance" id="balance">0 ₾</div>

<button class="pay-btn" onclick="openPopup()">გადარიცხვა</button>

<!-- POPUP -->
<div id="popup">
    <div id="popupBox">

        <h2 style="margin-bottom:10px;">გადარიცხვა</h2>

        <input type="text" id="iban" placeholder="ანგარიშის ნომერი (IBAN)">
        <input type="text" id="fullname" placeholder="სახელი და გვარი">
        <input type="number" id="amount" placeholder="თანხა (₾)" oninput="calc()">

        <p style="font-size:18px; margin-top:5px;">
            საკომისიო: <b>0.50 ₾</b>
        </p>

        <p style="font-size:20px;">
            ჩასარიცხი თანხა: <b id="finalAmount">0 ₾</b>
        </p>

        <button class="confirm" onclick="sendMoney()">დადასტურება</button>

        <button class="close" onclick="closePopup()">დახურვა</button>
    </div>
</div>

<script>
// URL-დან ამოაქვს ტელეფონის ნომერი
const urlParams = new URLSearchParams(window.location.search);
const phone = urlParams.get("phone");
document.getElementById("driverPhone").innerText = phone;

// Popup-ის გახსნა
function openPopup() {
    document.getElementById("popup").style.display = "block";
}

// Popup-ის დახურვა
function closePopup() {
    document.getElementById("popup").style.display = "none";
}

// საკომისიოს გამოთვლა
function calc() {
    let amount = parseFloat(document.getElementById("amount").value);
    if (isNaN(amount) || amount <= 0) {
        document.getElementById("finalAmount").innerText = "0 ₾";
        return;
    }
    let finalAmount = amount - 0.50;
    if (finalAmount < 0) finalAmount = 0;
    document.getElementById("finalAmount").innerText = finalAmount.toFixed(2) + " ₾";
}

// დროებითი გადარიცხვა
function sendMoney() {
    let iban = document.getElementById("iban").value;
    let name = document.getElementById("fullname").value;
    let amount = document.getElementById("amount").value;

    if (iban === "" || name === "" || amount === "") {
        alert("გთხოვ შეავსო ყველა ველი");
        return;
    }

    alert(
        "გადარიცხვა შესრულდა!\n" +
        "მიმღები: " + name + "\n" +
        "IBAN: " + iban + "\n" +
        "თანხა: " + amount + " ₾\n" +
        "დარიცხვა რეალურად ჩავრთავთ API-ზე მიერთებისას."
    );

    closePopup();
}
</script>

</body>
</html>
